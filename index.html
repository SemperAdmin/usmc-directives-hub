<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<!-- Content Security Policy for enhanced security -->
<meta http-equiv="Content-Security-Policy" content="
  default-src 'self';
  script-src 'self' https://unpkg.com/web-vitals@3.5.0/;
  style-src 'self' 'unsafe-inline';
  img-src 'self' data: https:;
  connect-src 'self'
    https://www.marines.mil
    https://www.mynavyhr.navy.mil
    https://www.secnav.navy.mil
    https://www.igmc.marines.mil
    https://www.esd.whs.mil
    https://comptroller.defense.gov
    https://www.travel.dod.mil
    https://usmc-directives-proxy.onrender.com
    http://localhost:3000
    https://corsproxy.io
    https://api.allorigins.win
    https://cors-anywhere.herokuapp.com
    https://api.codetabs.com;
  font-src 'self' data:;
  object-src 'none';
  base-uri 'self';
  form-action 'self';
  upgrade-insecure-requests;
">
<!-- Additional Security Headers -->
<!-- Note: X-Frame-Options only works via HTTP headers, not meta tags -->
<!-- Configure at hosting level (GitHub Pages, Render, etc.) for frame protection -->
<meta http-equiv="X-Content-Type-Options" content="nosniff">
<meta name="referrer" content="strict-origin-when-cross-origin">
<meta http-equiv="Permissions-Policy" content="geolocation=(), microphone=(), camera=(), payment=(), usb=()">
<title>USMC Directives Hub by Semper Admin</title>
<meta name="description" content="Search and track Marine Corps Messages, Publications, and Forms including MARADMINs, ALMARs, MCPUBs, and more.">
<meta name="theme-color" content="#1a1a1a">
<link rel="icon" type="image/svg+xml" href="icon.svg">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon.svg">
<link rel="stylesheet" href="style.css?v=23">
<link rel="stylesheet" href="ai-improvements.css?v=2">
</head>
<body>
<!-- Skip Navigation Link for Keyboard Accessibility -->
<a href="#main-content" class="skip-link">Skip to main content</a>

<header>
  <a href="https://linktr.ee/semperadmin" target="_blank" class="branding-link" aria-label="Visit Semper Admin on Linktree (opens in new tab)">
    <div class="branding">
      <img src="IMG_2324.jpeg" alt="Semper Admin Logo" class="header-logo">
      <div class="header-text">
        <h1>USMC Directives Hub</h1>
        <p class="byline">by Semper Admin</p>
      </div>
    </div>
  </a>
  <p class="subtitle">Search and track Marine Corps Messages, Publications, and Forms</p>
  <div class="controls">
    <button id="refreshBtn" aria-label="Refresh data from server">üîÑ Refresh</button>
    <button id="themeToggle" aria-label="Toggle dark mode">üåô Dark Mode</button>
  </div>
</header>
<main id="main-content">
  <div class="message-type-tabs" role="tablist" aria-label="Message type selection">
    <button class="message-type-btn" data-type="almar" role="tab" aria-selected="false" aria-controls="results">ALMARs <span class="tab-counter" aria-label="0 messages">0</span></button>
    <button class="message-type-btn" data-type="alnav" role="tab" aria-selected="false" aria-controls="results">ALNAVs <span class="tab-counter" aria-label="0 messages">0</span></button>
    <button class="message-type-btn" data-type="dodfmr" role="tab" aria-selected="false" aria-controls="results">DoD FMR <span class="tab-counter" aria-label="0 messages">0</span></button>
    <button class="message-type-btn" data-type="dodforms" role="tab" aria-selected="false" aria-controls="results">DoD Forms <span class="tab-counter" aria-label="0 messages">0</span></button>
    <button class="message-type-btn" data-type="igmc" role="tab" aria-selected="false" aria-controls="results">IGMC <span class="tab-counter" aria-label="0 messages">0</span></button>
    <button class="message-type-btn active" data-type="maradmin" role="tab" aria-selected="true" aria-controls="results">MARADMINs <span class="tab-counter" aria-label="0 messages">0</span></button>
    <button class="message-type-btn" data-type="jtr" role="tab" aria-selected="false" aria-controls="results">JTR <span class="tab-counter" aria-label="0 messages">0</span></button>
    <button class="message-type-btn" data-type="mcpub" role="tab" aria-selected="false" aria-controls="results">MCPUBs <span class="tab-counter" aria-label="0 messages">0</span></button>
    <button class="message-type-btn" data-type="secnav" role="tab" aria-selected="false" aria-controls="results">SECNAV <span class="tab-counter" aria-label="0 messages">0</span></button>
    <button class="message-type-btn" data-type="semperadmin" role="tab" aria-selected="false" aria-controls="results">Semper Admin <span class="tab-counter" aria-label="0 messages">0</span></button>
    <button class="message-type-btn" data-type="youtube" role="tab" aria-selected="false" aria-controls="results">YouTube <span class="tab-counter" aria-label="0 messages">0</span></button>
    <button class="message-type-btn all-messages-btn" data-type="all" role="tab" aria-selected="false" aria-controls="results">All Messages <span class="tab-counter" aria-label="0 messages">0</span></button>
  </div>
  <div class="filters-section">
    <div class="search-container">
      <label for="searchInput" class="sr-only">Search messages</label>
      <input type="text" id="searchInput" placeholder="Search by ID, subject, or keywords..." aria-describedby="searchHelp" />
      <button id="clearSearch" class="clear-btn" aria-label="Clear search">‚úï</button>
      <span id="searchHelp" class="sr-only">Enter keywords to filter messages</span>
    </div>
    <div class="filter-controls">
      <div class="quick-filters" role="group" aria-label="Quick date filters">
        <button class="quick-filter-btn active" data-days="1" aria-pressed="true">Today</button>
        <button class="quick-filter-btn" data-days="7" aria-pressed="false">This Week</button>
        <button class="quick-filter-btn" data-days="30" aria-pressed="false">This Month</button>
        <button class="quick-filter-btn" data-days="90" aria-pressed="false">Last 90 Days</button>
      </div>
      <label for="dateRange" class="sr-only">Date range filter</label>
      <select id="dateRange" aria-label="Select date range">
        <option value="1" selected>Last 24 hours</option>
        <option value="7">Last 7 days</option>
        <option value="14">Last 14 days</option>
        <option value="30">Last 30 days</option>
        <option value="60">Last 60 days</option>
        <option value="90">Last 90 days</option>
        <option value="0">All messages</option>
      </select>
    </div>
  </div>
  <div id="status" class="status" role="status" aria-live="polite">Loading cached data...</div>
  <div id="error" class="error hidden" role="alert" aria-live="assertive"></div>
  <div id="summaryStats" class="summary-stats hidden"></div>
  <div id="results" class="results" role="tabpanel" aria-label="Message results" tabindex="-1"></div>
</main>
<footer>
  <p class="semper-admin-branding">
    A <a href="https://linktr.ee/semperadmin" target="_blank" aria-label="Semper Admin (opens in new tab)">Semper Admin</a> Project
  </p>
  <p>Data source: <a href="https://www.marines.mil/News/Messages/" target="_blank" aria-label="Marines.mil Messages (opens in new tab)">Marines.mil Messages</a> & <a href="https://www.esd.whs.mil/Directives/forms/" target="_blank" aria-label="DoD Forms (opens in new tab)">DoD Forms</a> | Last updated: <span id="lastUpdate">Never</span></p>
  <p class="footer-links">
    <a href="https://www.facebook.com/profile.php?id=61558093420252" target="_blank" aria-label="Semper Admin on Facebook (opens in new tab)">Facebook</a> ‚Ä¢
    <a href="https://www.secnav.navy.mil/doni/Directives/Forms/doniAllInstructions.aspx" target="_blank" aria-label="SECNAV Directives (opens in new tab)">SECNAV</a> ‚Ä¢
    <a href="https://www.travel.dod.mil/" target="_blank" aria-label="Joint Travel Regulations (opens in new tab)">JTR</a> ‚Ä¢
    <a href="https://comptroller.war.gov/FMR/change/" target="_blank" aria-label="DoD Financial Management Regulation (opens in new tab)">DoD FMR</a>
  </p>
  <p class="footer-note">Auto-refreshes every 10 minutes ‚Ä¢ Data cached for offline access</p>
</footer>

<!-- Feedback Widget -->
<button id="feedbackBtn" class="feedback-btn" title="Share Feedback">üí¨ Feedback</button>

<!-- Feedback Modal -->
<div id="feedbackModal" class="feedback-modal hidden" role="dialog" aria-modal="true" aria-labelledby="feedbackModalTitle">
  <div class="feedback-modal-content">
    <div class="feedback-modal-header">
      <h2 id="feedbackModalTitle">Share Your Feedback</h2>
      <button id="closeFeedbackModal" class="feedback-close-btn" aria-label="Close feedback modal">‚úï</button>
    </div>
    <form id="feedbackForm">
      <div class="feedback-form-group">
        <label for="feedbackType">Feedback Type <span class="required">*</span></label>
        <select id="feedbackType" required>
          <option value="">Select type...</option>
          <option value="bug">Bug Report</option>
          <option value="feature">Feature Request</option>
          <option value="ux">UX Suggestion</option>
        </select>
      </div>

      <div class="feedback-form-group">
        <label for="feedbackTitle">Title <span class="required">*</span></label>
        <input type="text" id="feedbackTitle" placeholder="Brief summary of your feedback" required maxlength="100">
      </div>

      <div class="feedback-form-group">
        <label for="feedbackDescription">Description <span class="required">*</span></label>
        <textarea id="feedbackDescription" placeholder="Please describe your feedback in detail..." required rows="6"></textarea>
      </div>

      <div class="feedback-form-group">
        <label for="feedbackEmail">Email (Optional - will be public in GitHub issue)</label>
        <input type="email" id="feedbackEmail" placeholder="your@email.mil (visible publicly)" aria-describedby="emailPrivacyNote">
        <small id="emailPrivacyNote">‚ö†Ô∏è Your email will be visible in the public GitHub issue</small>
      </div>

      <div class="feedback-form-actions">
        <button type="button" id="cancelFeedback" class="feedback-btn-secondary">Cancel</button>
        <button type="submit" class="feedback-btn-primary">Submit Feedback</button>
      </div>

      <div id="feedbackStatus" class="feedback-status hidden"></div>
    </form>
  </div>
</div>

<script src="lib/fa-checklists.js"></script>
<script src="lib/secnav-data.js"></script>
<script src="lib/alnav-data.js"></script>

<!-- Web Vitals Library - Official Google library for Core Web Vitals -->
<!-- TODO: Download and host locally for better security (avoid CDN dependency) -->
<!-- SRI hash protects against CDN compromise - if load fails due to hash mismatch: -->
<!-- curl -sL https://unpkg.com/web-vitals@3.5.0/dist/web-vitals.iife.js | openssl dgst -sha384 -binary | openssl base64 -A -->
<script src="https://unpkg.com/web-vitals@3.5.0/dist/web-vitals.iife.js"
        integrity="sha384-5K8DvA/jQItSqMzBuJJX/9Up/DVImOuA7VTJuJux3zXhblA+NzZPI/rHSgIeEadg"
        crossorigin="anonymous"></script>

<script src="app.js?v=23"></script>

<!-- Service Worker Registration for PWA -->
<script src="pwa-init.js"></script>
</body>
</html>
